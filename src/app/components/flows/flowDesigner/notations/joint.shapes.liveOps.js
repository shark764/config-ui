(function() {
  'use strict';

  joint.shapes.liveOps = joint.shapes.liveOps || {};
  joint.shapes.liveOps.icons = {
    none: '',
    noneThrowing: '',
    message: 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiA/PjwhRE9DVFlQRSBzdmcgIFBVQkxJQyAnLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4nICAnaHR0cDovL3d3dy53My5vcmcvR3JhcGhpY3MvU1ZHLzEuMS9EVEQvc3ZnMTEuZHRkJz48c3ZnIGVuYWJsZS1iYWNrZ3JvdW5kPSJuZXcgMCAwIDUxMiA1MTIiIGhlaWdodD0iNTEycHgiIGlkPSJMYXllcl8xIiB2ZXJzaW9uPSIxLjEiIHZpZXdCb3g9IjAgMCA1MTIgNTEyIiB3aWR0aD0iNTEycHgiIHhtbDpzcGFjZT0icHJlc2VydmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPjxwYXRoIGQ9Ik00NzkuOTk4LDY0SDMyQzE0LjMyOSw2NCwwLDc4LjMxMiwwLDk2djMyMGMwLDE3LjY4OCwxNC4zMjksMzIsMzIsMzJoNDQ3Ljk5OEM0OTcuNjcxLDQ0OCw1MTIsNDMzLjY4OCw1MTIsNDE2Vjk2ICBDNTEyLDc4LjMxMiw0OTcuNjcxLDY0LDQ3OS45OTgsNjR6IE00MTYsMTI4TDI1NiwyNTZMOTYsMTI4SDQxNnogTTQ0OCwzODRINjRWMTYwbDE5MiwxNjBsMTkyLTE2MFYzODR6Ii8+PC9zdmc+',
    plus: 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiA/PjwhRE9DVFlQRSBzdmcgIFBVQkxJQyAnLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4nICAnaHR0cDovL3d3dy53My5vcmcvR3JhcGhpY3MvU1ZHLzEuMS9EVEQvc3ZnMTEuZHRkJz48c3ZnIGVuYWJsZS1iYWNrZ3JvdW5kPSJuZXcgMCAwIDI0IDI0IiBoZWlnaHQ9IjI0cHgiIGlkPSJMYXllcl8xIiB2ZXJzaW9uPSIxLjEiIHZpZXdCb3g9IjAgMCAyNCAyNCIgd2lkdGg9IjI0cHgiIHhtbDpzcGFjZT0icHJlc2VydmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPjxwYXRoIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTIyLjUsMTRIMTR2OC41YzAsMC4yNzYtMC4yMjQsMC41LTAuNSwwLjVoLTRDOS4yMjQsMjMsOSwyMi43NzYsOSwyMi41VjE0SDAuNSAgQzAuMjI0LDE0LDAsMTMuNzc2LDAsMTMuNXYtNEMwLDkuMjI0LDAuMjI0LDksMC41LDlIOVYwLjVDOSwwLjIyNCw5LjIyNCwwLDkuNSwwaDRDMTMuNzc2LDAsMTQsMC4yMjQsMTQsMC41VjloOC41ICBDMjIuNzc2LDksMjMsOS4yMjQsMjMsOS41djRDMjMsMTMuNzc2LDIyLjc3NiwxNCwyMi41LDE0eiIgZmlsbC1ydWxlPSJldmVub2RkIi8+PC9zdmc+',
    cross: 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiA/PjwhRE9DVFlQRSBzdmcgIFBVQkxJQyAnLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4nICAnaHR0cDovL3d3dy53My5vcmcvR3JhcGhpY3MvU1ZHLzEuMS9EVEQvc3ZnMTEuZHRkJz48c3ZnIGVuYWJsZS1iYWNrZ3JvdW5kPSJuZXcgMCAwIDI0IDI0IiBoZWlnaHQ9IjI0cHgiIGlkPSJMYXllcl8xIiB2ZXJzaW9uPSIxLjEiIHZpZXdCb3g9IjAgMCAyNCAyNCIgd2lkdGg9IjI0cHgiIHhtbDpzcGFjZT0icHJlc2VydmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPjxwYXRoIGQ9Ik0yMi4yNDUsNC4wMTVjMC4zMTMsMC4zMTMsMC4zMTMsMC44MjYsMCwxLjEzOWwtNi4yNzYsNi4yN2MtMC4zMTMsMC4zMTItMC4zMTMsMC44MjYsMCwxLjE0bDYuMjczLDYuMjcyICBjMC4zMTMsMC4zMTMsMC4zMTMsMC44MjYsMCwxLjE0bC0yLjI4NSwyLjI3N2MtMC4zMTQsMC4zMTItMC44MjgsMC4zMTItMS4xNDIsMGwtNi4yNzEtNi4yNzFjLTAuMzEzLTAuMzEzLTAuODI4LTAuMzEzLTEuMTQxLDAgIGwtNi4yNzYsNi4yNjdjLTAuMzEzLDAuMzEzLTAuODI4LDAuMzEzLTEuMTQxLDBsLTIuMjgyLTIuMjhjLTAuMzEzLTAuMzEzLTAuMzEzLTAuODI2LDAtMS4xNGw2LjI3OC02LjI2OSAgYzAuMzEzLTAuMzEyLDAuMzEzLTAuODI2LDAtMS4xNEwxLjcwOSw1LjE0N2MtMC4zMTQtMC4zMTMtMC4zMTQtMC44MjcsMC0xLjE0bDIuMjg0LTIuMjc4QzQuMzA4LDEuNDE3LDQuODIxLDEuNDE3LDUuMTM1LDEuNzMgIEwxMS40MDUsOGMwLjMxNCwwLjMxNCwwLjgyOCwwLjMxNCwxLjE0MSwwLjAwMWw2LjI3Ni02LjI2N2MwLjMxMi0wLjMxMiwwLjgyNi0wLjMxMiwxLjE0MSwwTDIyLjI0NSw0LjAxNXoiLz48L3N2Zz4=',
    user: 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiA/PjwhRE9DVFlQRSBzdmcgIFBVQkxJQyAnLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4nICAnaHR0cDovL3d3dy53My5vcmcvR3JhcGhpY3MvU1ZHLzEuMS9EVEQvc3ZnMTEuZHRkJz48c3ZnIGVuYWJsZS1iYWNrZ3JvdW5kPSJuZXcgMCAwIDI0IDI0IiBoZWlnaHQ9IjI0cHgiIGlkPSJMYXllcl8xIiB2ZXJzaW9uPSIxLjEiIHZpZXdCb3g9IjAgMCAyNCAyNCIgd2lkdGg9IjI0cHgiIHhtbDpzcGFjZT0icHJlc2VydmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPjxwYXRoIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTIyLDIwLjk5OGgtMWMwLDAtMSwwLTEtMVYxNy41YzAtMC4yNzctMC4yMjQtMC41LTAuNS0wLjVTMTksMTcuMjIzLDE5LDE3LjUgIGwtMC4wMDgsNC4yOTVjMCwwLjYwOS0yLjAxLDIuMjA1LTYuNDkyLDIuMjA1cy02LjQ5Mi0xLjU5Ni02LjQ5Mi0yLjIwNUw2LDE3LjVDNiwxNy4yMjMsNS43NzYsMTcsNS41LDE3UzUsMTcuMjIzLDUsMTcuNXYyLjQ5OCAgYzAsMS0xLDEtMSwxSDNjMCwwLTEsMC0xLTFWMTUuNzVjMC0yLjkyMiwyLjg5Mi01LjQwMSw2LjkzLTYuMzQxYzAsMCwxLjIzNCwxLjEwNywzLjU3LDEuMTA3czMuNTctMS4xMDcsMy41Ny0xLjEwNyAgYzQuMDM4LDAuOTQsNi45MywzLjQxOSw2LjkzLDYuMzQxdjQuMjQ4QzIzLDIwLjk5OCwyMiwyMC45OTgsMjIsMjAuOTk4eiBNMTIuNDc3LDljLTIuNDg1LDAtNC41LTIuMDE1LTQuNS00LjVTOS45OTEsMCwxMi40NzcsMCAgczQuNSwyLjAxNSw0LjUsNC41UzE0Ljk2Miw5LDEyLjQ3Nyw5eiIgZmlsbC1ydWxlPSJldmVub2RkIi8+PC9zdmc+',
    circle: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH3gULEBE3DEP64QAAAwlJREFUaN7dmktrU0EUx38ZmmBbfEIL2hSjkYKC1EW6EDFudC+404/gE6WKSvGxERQfIH4AX1T9EOKrCrYurVrbgsZWoaBVixDbpC6ci+Fyz9ybZG478cBs7syc+Z+5c86c+c8ksCPrgW1ADtgEbARafG1+AW+AYWAIGADGWUTZAJwHxoD5GssocA7ILiTwLcADoFQHcH8pAfeB7jiBtwO3gLJF4P5S1mO02wa/C5iMEbi/TAI7bYE/Y3m5VLOs+sLAJULqrgKHIxhZBp4DT4FX2jkLGoinq1M7fg7YDmwFVATd14CjFboiy5UIs/QBOAmka/izaeCU1hE2zuVqlZ8IUfgVOAA0WViiTcBBrdM0Zm9UhTuAOYOiRzXOeJh0Ak8M484B+TAlK4BPBiU3gWSMoTqpw6g0fgFYblJww9D5dojT25IEcMeA47rUsdsQLp9FmPmURSNSOqpJS2lzUKd+ocN3IBNx5mz+oXXADwHTXX/jjMFxjy1iwtgrYJoF1lY27BMafozZaaMspYKA7XRlw7f1xt4Y5biA7bXXIGv4TW0OGNCmsQRhzCidlwTJADDlgAFTwAuhLq+AHqHyMe6IhKVHAV1C5ZBDBkhYupThPPreIQNGJTJBGXKLLw4Z8NmQu/Fb8PCkQwakBIxFRWPLvAJmhMpWh4AuFb7PKGBaqFzjkAGrhe/TSjNrQZJ1yAAJy5gCRoTKnEMGSFhGFDBoOBu7IhKWQe8wLRFLHQ6A7zCcFNNK59vvAjoqYK8DBuwTCLBhTUD8Hweahj9S2jjU297VqzrU26BVmi2yEjXRKg1PbHnpqYla7AeWxAi+GbhHHdSit2mYyN2XQQ5kQTJ6Y6qL3PUkCr2+H7v0+jcs0eueRLngGNeKa9mxY73g8JzpEtHusorAQ/7e+e7WUWIl//jSVTrK7QEu6KgW9d7tYr3B44iBWPJfkZZ8pZ4r2VngkC0HywMTLNwN5YSBcKtZWoGzernEBbyox2iJc6Np2KcGfnHisYet1CDouc2yCjbhp07MrD+3+QNxi4JkAscRswAAAABJRU5ErkJggg==',
    signal: 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPg0KIDxnPg0KICAgPHBvbHlnb24gaWQ9InN2Z18xIiBwb2ludHM9IjMuMDE4OTk3MTkyMzgyODEyNSwzMy43MDMwMDI5Mjk2ODc1IDE5Ljk5NTAwMjc0NjU4MjAzLDQuMjk2OTk3MDcwMzEyNSAzNi45ODEwMDI4MDc2MTcxOSwzMy43MDMwMDI5Mjk2ODc1ICIgc3Ryb2tlLXdpZHRoPSIxLjUiIHN0cm9rZT0iIzAwMCAiIGZpbGw9Im5vbmUiLz4NCiA8L2c+DQo8L3N2Zz4=',
    'system-error': 'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" version="1.1"><polygon stroke-width="1.5" stroke="#000" fill-opacity="0" stroke-miterlimit="10" points="6.522,23.354 12.917,4.43 24.157,20.146 33.478,11.125 25.555,35.57 12.931,16.07"></polygon></svg>',
    'flow-error': 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZlcnNpb249IjEuMSI+PHBvbHlnb24gc3Ryb2tlLXdpZHRoPSIxLjUiIHN0cm9rZT0iIzAwMCIgZmlsbC1vcGFjaXR5PSIwIiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIHBvaW50cz0iMy40NTUsMzIuNjA3IDIwLjU0NiwzLjAwMyAzNy42MzgsMzIuNjA3IDIwLjU0NiwyNS41NDEiPjwvcG9seWdvbj48L3N2Zz4=',
    terminate: 'data:image/svg+xml;utf8, <svg xmlns="http://www.w3.org/2000/svg" version="1.1"><circle stroke-width="1.5" stroke="#000" fill-opacity="0" stroke-miterlimit="10" cx="20" cy="20" r="19"></circle></svg>',
    timer: 'data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIGlkPSJMYXllcl8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHg9IjBweCIgeT0iMHB4Ig0KCSB2aWV3Qm94PSIwIDAgNDAgNDAiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDQwIDQwOyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+DQo8Zz4NCgk8Zz4NCgkJPGc+DQoJCQk8cGF0aCBjbGFzcz0ic3QwIiBkPSJNMjguMiwyMS41YzAsMC4zLTAuMiwwLjUtMC41LDAuNWgtOC42Yy0wLjEsMC0wLjEsMC0wLjEsMGMwLDAsMCwwLDAsMGMwLDAtMC4xLDAtMC4xLDBjMCwwLDAsMC0wLjEsMA0KCQkJCWMwLDAsMCwwLDAsMGMwLDAsMCwwLTAuMS0wLjFjLTAuMS0wLjEtMC4xLTAuMS0wLjEtMC4yYzAsMCwwLTAuMSwwLTAuMWMwLDAsMC0wLjEsMC0wLjFjMCwwLDAsMCwwLTAuMWMwLDAsMC0wLjEsMC0wLjENCgkJCQljMCwwLDAsMCwwLDBjMCwwLDAsMCwwLDBsNS0xMi44YzAuMS0wLjMsMC40LTAuNCwwLjctMC4zYzAuMywwLjEsMC40LDAuNCwwLjMsMC43TDE5LjksMjFoNy44QzI4LDIxLDI4LjIsMjEuMiwyOC4yLDIxLjV6Ii8+DQoJCTwvZz4NCgk8L2c+DQoJPHBhdGggY2xhc3M9InN0MCIgZD0iTTIwLjUsMS41QzEwLjMsMS41LDIsOS44LDIsMjBjMCwxMC4yLDguMywxOC41LDE4LjUsMTguNUMzMC43LDM4LjUsMzksMzAuMiwzOSwyMEMzOSw5LjgsMzAuNywxLjUsMjAuNSwxLjV6DQoJCSBNMzYuNiwyNy42bC0yLTFsLTAuNywxLjNsMiwxLjFjLTEuMywyLjMtMy4yLDQuMy01LjMsNS44bC0xLjEtMS41bC0xLjIsMC44bDEsMS41Yy0yLjQsMS40LTUuMiwyLjMtOC4yLDIuNHYtMS45aC0xLjR2MS45DQoJCWMtMy0wLjEtNS44LTEtOC4yLTIuNGwxLTEuNWwtMS4yLTAuOGwtMS4xLDEuNWMtMi4yLTEuNS00LTMuNS01LjMtNS44bDItMS4xbC0wLjctMS4zbC0yLDFjLTEtMi4xLTEuNi00LjQtMS43LTYuOGgyLjF2LTEuNEgyLjcNCgkJYzAuMS0yLjQsMC43LTQuOCwxLjctNi44bDIsMWwwLjctMS4zbC0yLTEuMWMxLjMtMi4zLDMuMi00LjMsNS4zLTUuOGwxLjEsMS41bDEuMi0wLjhsLTEtMS41YzIuNC0xLjQsNS4yLTIuMyw4LjItMi40djEuOWgxLjRWMi4yDQoJCWMzLDAuMSw1LjgsMSw4LjIsMi40bC0xLDEuNWwxLjIsMC44bDEuMS0xLjVjMi4yLDEuNSw0LDMuNSw1LjMsNS44bC0yLDEuMWwwLjcsMS4zbDItMWMxLDIuMSwxLjYsNC40LDEuNyw2LjhoLTIuMXYxLjRoMi4xDQoJCUMzOC4xLDIzLjEsMzcuNSwyNS41LDM2LjYsMjcuNnoiLz4NCjwvZz4NCjwvc3ZnPg0K',
    signalThrowing: 'data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeD0iMHB4IiB5PSIwcHgiIHdpZHRoPSI0MHB4IiBoZWlnaHQ9IjQwcHgiIHZpZXdCb3g9IjgwIDgwIDQwIDQwIiBlbmFibGUtYmFja2dyb3VuZD0ibmV3IDgwIDgwIDQwIDQwIiB4bWw6c3BhY2U9InByZXNlcnZlIj48cG9seWdvbiBmaWxsPSIjMDAwIiBzdHJva2Utd2lkdGg9IjEuNSIgcG9pbnRzPSI4My4wMTksMTE0LjcwMyA5OS45OTUsODUuMjk3IDExNi45ODEsMTE0LjcwMyAiLz48L3N2Zz4=',
    'system-errorThrowing': 'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" version="1.1"><polygon stroke-miterlimit="10" points="6.522,23.354 12.917,4.43 24.157,20.146 33.478,11.125 25.555,35.57 12.931,16.07"></polygon></svg>',
    'flow-errorThrowing': 'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" version="1.1"><polygon stroke-miterlimit="10" points="3.455,32.607 20.546,3.003 37.638,32.607 20.546,25.541"></polygon></svg>',
    terminateThrowing: 'data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIGlkPSJMYXllcl8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHg9IjBweCIgeT0iMHB4Ig0KCSB2aWV3Qm94PSIwIDAgNDAgNDAiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDQwIDQwOyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+DQo8Y2lyY2xlIGN4PSIyMCIgY3k9IjIwIiByPSIyMCIvPg0KPC9zdmc+',
    event: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTAiIGhlaWdodD0iNTAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+DQogPCEtLSBDcmVhdGVkIHdpdGggU1ZHLWVkaXQgLSBodHRwOi8vc3ZnLWVkaXQuZ29vZ2xlY29kZS5jb20vIC0tPg0KIDxnPg0KICA8dGl0bGU+TGF5ZXIgMTwvdGl0bGU+DQogIDxjaXJjbGUgc3Ryb2tlLXdpZHRoPSIxLjUiIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzAwMDAwMCIgc3Ryb2tlLWxpbmVqb2luPSJudWxsIiBzdHJva2UtbGluZWNhcD0ibnVsbCIgY3g9IjI0LjYxNTM4NiIgY3k9IjI0LjYxNTM4NiIgcj0iMjMuNzg0Njc4IiBpZD0ic3ZnXzEiLz4NCiAgPGNpcmNsZSBzdHJva2Utd2lkdGg9IjEuNSIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMDAwMDAwIiBzdHJva2UtbGluZWpvaW49Im51bGwiIHN0cm9rZS1saW5lY2FwPSJudWxsIiBjeD0iMjQuNjE1Mzg3IiBjeT0iMjQuNjE1Mzg3IiByPSIyMC40OTE1NzMiIGlkPSJzdmdfMiIvPg0KICA8cGF0aCBzdHJva2Utd2lkdGg9IjEuNSIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMDAwMDAwIiBzdHJva2UtbGluZWpvaW49Im51bGwiIHN0cm9rZS1saW5lY2FwPSJudWxsIiBkPSJtOS44MzQ5MzcsMjAuMDEwMzQybDE0Ljc4MDQ1LC0xMC43NTM1OTRsMTQuNzgwNDQ5LDEwLjc1MzU5NGwtNS42NDU3NjMsMTcuMzk5NTlsLTE4LjI2OTYzOSwwbC01LjY0NTQ5NiwtMTcuMzk5NTlsMCwweiIgaWQ9InN2Z18zIi8+DQogPC9nPg0KPC9zdmc+'
  };

  joint.shapes.liveOps.IconInterface = {
    initialize: function() {
      // In order to be able to use multiple interfaces for one Backbone.model, we need to keep
      // reference to the actual parent class prototype.
      this._parent = (this._parent || this).constructor.__super__;
      this._parent.initialize.apply(this, arguments);
      this.listenTo(this, 'change:icon', this._onIconChange);
      this._onIconChange(this, this.get('icon') || 'none');
    },
    _onIconChange: function(cell, icon) {
      var icons = joint.shapes.liveOps.icons;
      if (_.has(icons, icon)) {
        cell.attr('image/xlink:href', icons[icon]);
      } else {
        throw 'BPMN: Unknown icon: ' + icon;
      }
    }
  };

  joint.shapes.liveOps.SubProcessInterface = {
    initialize: function() {
      // See IconInterface.initalize()
      this._parent = (this._parent || this).constructor.__super__;
      this._parent.initialize.apply(this, arguments);
      this.listenTo(this, 'change:subProcess', this._onSubProcessChange);
      this._onSubProcessChange(this, this.get('subProcess') || null);
    },
    _onSubProcessChange: function(cell, subProcess) {
      cell.attr({
        '.sub-process': {
          visibility: subProcess ? 'visible' : 'hidden',
          'data-sub-process': subProcess || ''
        }
      });
    }
  };
})();
